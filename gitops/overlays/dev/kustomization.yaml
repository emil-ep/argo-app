apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: ecommerce-dev

bases:
  - ../../base/database
  - ../../base/backend
  - ../../base/frontend

resources:
  - ingress.yaml
  - namespace.yaml

patchesStrategicMerge:
  # backend-patch.yaml removed - using Rollout instead of Deployment
  - frontend-patch.yaml

images:
  - name: ecommerce-backend
    newName: ghcr.io/emil-ep/argo-app/backend
    newTag: 845ad3e
  - name: ecommerce-frontend
    newName: ghcr.io/emil-ep/argo-app/frontend
    newTag: 845ad3e

# Note: commonLabels removed to avoid conflicts with Argo Rollouts
# Argo Rollouts validates that service selectors match rollout selectors
# commonLabels would add environment: dev to rollout selector, causing mismatch

# Made with Bob
